/**
 * New node file
 */
var api_version = '0.1';
var endpoint_url = 'api.positronics.io';

var locations = '/locations';
var items = 'items';
var modifiers = 'modifiers';
var modifier_id = '{modifier_id}';
var modifier_groups = 'modifier_groups';
var modifier_group_id = '{modifier_group_id}';
var menu = 'menu';
var categories = 'categories';
var category_id = '{category_id}';
var menu_item_id = '{menu_item_id}';
var tickets = 'tickets';
var ticket_id = '{ticket_id}'
var ticket_item_id = '{ticket_item_id}';
var ticket_item_modifier_id = '{ticket_item_modofier_id}';
var tables = 'tables';
var table_id = '{table_id}';
var employees = 'employees';
var location_id = '{location_id}';
var employee_id = '{employee_id}';
var order_types = 'order_types';
var order_type_id = '{order_type_id}';
var tender_types = 'tender_types';
var tender_type_id = '{tender_type_id}';
var revenue_centers = 'revenue_centers';
var revenue_center_id = '{revenue_center_id}';
var payments = 'payments';
var payment_id = '{payment_id}';


var get_api_version = function() { return api_verion;};
var set_api_version = function(new_api_version) {  api_version=new_api_version;};
var get_base_url = function() { return endpoint_url+'/'+api_version;};


//
var apis = {

		tables					: [tables,table_id,],
		employees   			: [employees,employee_id,],
		order_types 			: [order_types,order_type_id,],
		tender_types 			: [tender_types,tender_type_id,],		
		revenue_centers 		: [revenue_centers,revenue_center_id,],		
		tickets					: [tickets,ticket_id,items,ticket_item_id,modifiers,ticket_item_modifier_id,],		
		payments				: [payments,payment_id],		
		//...
		//...order is important
		//...
		menu 					: [menu,],
		menu_categories 		: [menu,category_id,],
		menu_item				: [menu,menu_item_id,modifier_groups,modifier_group_id,],
		menu_modifiers			: [menu,modifier_id,],
};



var gen_urls = function () {

	urls = {locations : '/locations/{location_id}'};
	for(api in apis) {
		var _urls = [];
		var url = '/locations/{location_id}';
		for(i in apis[api]) {
			url += '/'+apis[api][i];
 			if(apis[api][i]!=undefined) {
				urls[apis[api][i]] = url;
			}
		}
	}

}

api_urls = gen_urls();

var get_locations_url = function() {
	return get_base_url()+'/locations';
}

var get_location_url = function() {
	return get_base_url()+url['locations']
}
var get_location_tickets_url = function(p_location_id) { 
	var the_url = get_base_url()+urls['tickets'];
	the_url = the_url.replace(location_id,p_location_id)
	return the_url;
	
}

var gen_ticket_args = function (p_location_id,p_ticket_id,p_items,p_ticket_item_id,p_modifiers,p_modifier_id) {
	var args = {
			'{location_id}':p_location_id,'{ticket_id}':p_ticket_id,
			'items':true,
			'ticket_item_id':p_ticket_item_id,
			'modifiers':p_modifiers,
			'modifier_id':p_modifier_id,
			
	};
	return args;
}

var get_location_ticket_url = function(p_location_id,p_ticket_id) { 
	var the_url = get_base_url()+urls[ticket_id];
	the_url = the_url.replace(location_id,p_location_id);
	the_url = the_url.replace(ticket_id,p_ticket_id);
	return the_url;
}

var get_location_ticket_items_url = function(p_location_id,p_ticket_id) { 
	var the_url = get_base_url()+urls[items];
	the_url = the_url.replace(location_id,p_location_id);
	the_url = the_url.replace(ticket_id,p_ticket_id);
	return the_url;
}

var get_location_ticket_item_id_url = function(p_location_id,p_ticket_id,p_ticket_item_id) { 
	var the_url = get_base_url()+urls[ticket_item_id];
	the_url = the_url.replace(location_id,p_location_id);
	the_url = the_url.replace(ticket_id,p_ticket_id);
	the_url = the_url.replace(ticket_item_id,p_ticket_item_id);
	return the_url;
}

function get_location_tickets(p_location_id) {
	var the_url = get_base_url()+urls[tickets];
	the_url = the_url.replace(location_id,p_location_id);
	return the_url;
}

function get_location_ticket_id(p_args) {
	var the_url = get_base_url()+urls[ticket_id];
	the_url = the_url.replace(location_id,p_args[location_id]);
	the_url = the_url.replace(ticket_id,p_args[ticket_id]);
	return the_url;
}

function get_location_ticket_items(p_args) {
	the_url = get_location_ticket_id(p_args);
	if(p_args[items]!=undefined) {
		the_url += '/'+items;		
	}
	return the_url;
}

function get_location_ticket_item_id(p_args) {
	the_url = get_location_ticket_items(p_args);
	if(p_args[ticket_item_id]!=undefined) {
		if(p_args[items]==undefined) {
			throw new Error('missing items keywords');
		}
		the_url += '/'+p_args[ticket_item_id];		
	}
	return the_url;
}

function get_location_ticket_item_id_modifiers(p_args) {
	the_url = get_location_ticket_item_id(p_args);
	if(p_args[modifiers]!=undefined) {
		if(p_args[ticket_item_id]==undefined) {
			throw new Error('missing ticket_item_id keyword');
		}
		the_url += '/'+modifiers;		
	}
	return the_url;
}

function get_location_ticket_item_id_modifier_id(p_args) {
	the_url = get_location_ticket_item_id_modifiers(p_args);
	if(p_args[modifier_id]!=undefined) {
		if(p_args[modifiers]==undefined) {
			throw new Error('missing modifiers keyword');
		}
		the_url += '/'+p_args[modifier_id];
	}
	return the_url;
}


var get_location_ticket = function(p_args) {
	return get_location_ticket_item_id_modifier_id(p_args);
	
}

var get_location_menu_url = function(p_location_id) { 
	var the_url = get_base_url()+urls[menu];
	the_url.replace(location_id,p_location_id);
	return the_url;
}

var get_location_tables_url = function(p_location_id) { 
	var the_url = get_base_url()+urls[tables];
	the_url = the_url.replace(location_id,p_location_id);
	return the_url;
}

var get_location_table_url = function(p_location_id,p_table_id) { 
	var the_url = get_base_url()+urls[table_id];
	the_url = the_url.replace(location_id,p_location_id);
	the_url = the_url.replace(table_id,p_table_id);
	return the_url;
}

var get_location_employees_url = function(p_location_id) { 
	var the_url = get_base_url()+urls[employees];
	the_url = the_url.replace(location_id,p_location_id);
	return the_url;
}

var get_location_employee_url = function(p_location_id,p_employee_id) { 
	var the_url = get_base_url()+urls[employee_id];
	the_url = the_url.replace(location_id,p_location_id);
	the_url = the_url.replace(p_employee_id,p_employee_id);
	return the_url;
}

exports.location_id;
exports.ticket_id;
exports.ticket_item_id = ticket_item_id;
exports.modifiers = modifiers;
exports.modifier_id = modifier_id;
exports.get_api_version = get_api_version;
exports.set_api_version = set_api_version;
exports.get_base_url = get_base_url;
exports.get_locations_url = get_locations_url;
exports.get_location_tickets_url = get_location_tickets_url;
exports.gen_ticket_args = gen_ticket_args;
exports.get_location_ticket_url = get_location_ticket_url;
exports.get_location_ticket_items_url = get_location_ticket_items_url;
exports.get_location_ticket_item_id_url = get_location_ticket_item_id_url;
exports.get_location_menu_url = get_location_menu_url;
exports.get_location_tables_url = get_location_tables_url;
exports.get_location_table_url = get_location_table_url;
exports.get_location_employees_url = get_location_employees_url;
exports.get_location_employee_url = get_location_employee_url;

exports.get_location_ticket = get_location_ticket;